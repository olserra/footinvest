<h1>this is my_players page</h1>

<% @my_players.each do |player| %>
  <%= image_tag(player.photo, height: '32', width: '32', crop: :fill) %> |
  <%= player.name %> <%= player.id %> |
  <%= player.position %> |

  <% form = [] %>
  <% goals = [] %>
  <% assists = [] %>

  <% player.stats.each do |stat| %>
    <% form << stat.form.downcase %>
    <% goals << stat.goals %>
    <% assists << stat.assists %>
  <% end %>

  <% if form.include?('high') %>
    <% form = 'HGH' %>
  <% elsif form.include?('medium') %>
    <% form = 'AVG' %>
  <% elsif form.include?('low') %>
    <% form = 'LOW' %>
  <% else %>
    <% form = '-' %>
  <% end %>

  form: <%= form %> |
  goals: <%= goals.inject(0){|sum,x| sum + x } %> |
  assists: <%= assists.inject(0){|sum,x| sum + x } %> |

  <% prices = [] %>

  <% @transactions.each do |transaction| %>
    <% prices << transaction.price if transaction.player_id == player.id %>
  <% end %>

  last price: <%= prices.first %> € |
  min price: <%= prices.min %> € |
  max price: <%= prices.max %> € |

  <% variations = [] %>

  <% @transactions.each do |transaction| %>
    <% variations << transaction.price if transaction.player_id == player.id %>
  <% end %>

  last variation: <%= variations.first %> % |
  min variation: <%= variations.min %> % |
  max variation: <%= variations.max %> % |

  <br>

<% end %>

<% @transactions.each do |transaction| %>
  <%= transaction.date_time %> <%= transaction.player.name %> <%= transaction.price %> <%= transaction.player.id %> <br>
<% end %>

<br>
<br>

<% @my_players2.each do |player| %>
  <%= player.id %> | <%= player.owner %> | <%= player.last_price %> | <%= player.name %> <br>
<% end %>
